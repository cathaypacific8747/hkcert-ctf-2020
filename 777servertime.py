import socket
import time
 
class Netcat:
    """ Python 'netcat like' module """
    def __init__(self, ip, port):
        self.buff = ""
        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.socket.connect((ip, port))

    def read(self, length = 1024):
        """ Read 1024 bytes off the socket """
        return self.socket.recv(length)
 
    def read_until(self, data):
        """ Read data into the buffer until we have data """
        while not data in self.buff:
            self.buff += self.socket.recv(1024)
 
        pos = self.buff.find(data)
        rval = self.buff[:pos + len(data)]
        self.buff = self.buff[pos + len(data):]
 
        return rval
 
    def write(self, data):
        self.socket.send(data)
    
    def close(self):
        self.socket.close()

d = {
    '000': 'H5226750',
    '003': 'H4293896',
    '004': 'T6488891',
    '006': 'D0289133',
    '007': 'A7316502',
    '009': 'P7057826',
    '010': 'C8690489',
    '011': 'T4638241',
    '012': 'A7501210',
    '014': 'C2984723',
    '015': 'D0191222',
    '017': 'B0288999',
    '020': 'H9754824',
    '021': 'A4632330',
    '022': 'O7175060',
    '023': 'C7939718',
    '024': 'F9226334',
    '025': 'A9763220',
    '026': 'G1202137',
    '027': 'A8680143',
    '028': 'K0633119',
    '029': 'N3962804',
    '030': 'U120331A',
    '031': 'G9813666',
    '033': 'E9317752',
    '034': 'K3497658',
    '035': 'E8699686',
    '036': 'J4613063',
    '037': 'P4751543',
    '038': 'D8069477',
    '039': 'Y2914997',
    '041': 'A1808780',
    '042': 'L1910674',
    '043': 'A6770986',
    '044': 'G5283115',
    '045': 'E8384375',
    '046': 'L3708147',
    '047': 'I9881934',
    '048': 'L1458046',
    '049': 'B2029540',
    '051': 'E7547270',
    '052': 'G3469602',
    '053': 'G8939070',
    '054': 'D2770149',
    '056': 'G3251577',
    '057': 'F3113031',
    '058': 'E7669511',
    '059': 'M4143669',
    '060': 'Y1986285',
    '061': 'B879995A',
    '062': 'R5130483',
    '064': 'D6733698',
    '065': 'B8106865',
    '066': 'D8520772',
    '067': 'O5774048',
    '068': 'C1955169',
    '069': 'E3046226',
    '071': 'V7990235',
    '072': 'Z4294956',
    '073': 'C6754692',
    '076': 'A0605029',
    '250': 'C9880753',
    '251': 'E5090702',
    '252': 'B0905637',
    '253': 'F5248732',
    '254': 'U918246A',
    '255': 'E0838385',
    '258': 'B210612A',
    '261': 'R5128519',
    '262': 'Q9714428',
    '263': 'K9235450',
    '264': 'M5155687',
    '265': 'I4223343',
    '266': 'B8796519',
    '267': 'G618403A',
    '268': 'Y9082857',
    '269': 'L9011962',
    '271': 'A3915525',
    '272': 'D0938026',
    '274': 'H9854306',
    '275': 'M9883946',
    '276': 'D2171512',
    '277': 'L1869364',
    '278': 'V2093383',
    '280': 'J4932223',
    '281': 'M1679266',
    '282': 'T4381046',
    '283': 'B6581515',
    '284': 'T9383926',
    '288': 'E1867710',
    '289': 'B1242747',
    '290': 'J5811799',
    '292': 'A5641627',
    '293': 'N8018330',
    '294': 'X6887185',
    '295': 'O0453243',
    '296': 'B4596922',
    '297': 'Z5644098',
    '298': 'B7719723',
    '299': 'O093800A',
    '301': 'F0591242',
    '302': 'G4935917',
    '325': 'M4923796',
    '326': 'D3499481',
    '327': 'W3167162',
    '328': 'P1881829',
    '329': 'A4597667',
    '331': 'O318796A',
    '332': 'F4035891',
    '333': 'A8638430',
    '334': 'F2735365',
    '336': 'D3533426',
    '337': 'B4982016',
    '338': 'P9501715',
    '339': 'E3097610',
    '341': 'E0736965',
    '342': 'R6528626',
    '343': 'O5254753',
    '345': 'X6060574',
    '348': 'F3574187',
    '349': 'B1756074',
    '351': 'D0606619',
    '353': 'C9031136',
    '354': 'A2452653',
    '355': 'F8869606',
    '356': 'M8700228',
    '357': 'C622037A',
    '359': 'K3803562',
    '360': 'E3385500',
    '361': 'F7321933',
    '362': 'F8906153',
    '363': 'E7059292',
    '364': 'U7268693',
    '366': 'V9366717',
    '368': 'L2065978',
    '369': 'X0056141',
    '370': 'K0511633',
    '371': 'B3761652',
    '372': 'D6408487',
    '373': 'A0463801',
    '374': 'H8318397',
    '375': 'B6486121',
    '376': 'N7352709',
    '377': 'A9964722',
    '378': 'H3538062',
    '379': 'D0292916',
    '381': 'P1490099',
    '382': 'J0330784',
    '383': 'I6204540',
    '500': 'D1747178',
    '501': 'P2621456',
    '505': 'H8748014',
    '506': 'G9017118',
    '507': 'K9856072',
    '508': 'P7184410',
    '509': 'A8782728',
    '511': 'E3377702',
    '512': 'T9783681',
    '513': 'M1107726',
    '514': 'B1027668',
    '515': 'Q4367622',
    '517': 'J5889429',
    '519': 'G5332264',
    '520': 'J5108133',
    '521': 'M2050582',
    '522': 'S9242580',
    '523': 'M4843148',
    '524': 'R1822658',
    '526': 'G5933659',
    '527': 'G0102678',
    '528': 'P9333693',
    '529': 'J144399A',
    '530': 'T7032395',
    '531': 'H2757801',
    '532': 'P9616911',
    '533': 'G3191876',
    '534': 'B9108985',
    '535': 'T5231390',
    '536': 'L2049107',
    '537': 'F7765041',
    '538': 'K6637582',
    '539': 'L4214938',
    '540': 'D2774047',
    '541': 'B1425418',
    '542': 'N2958668',
    '543': 'P093502A',
    '545': 'R8841844',
    '547': 'D5064202',
    '548': 'T0097661',
    '549': 'M3255129',
    '550': 'J2052900',
    '551': 'G0741492',
    '552': 'D9732978',
    '553': 'K541363A',
    '554': 'B5865544',
    '555': 'B4817996',
    '556': 'O6106693',
    '557': 'C1504035',
    '558': 'E531435A',
    '559': 'P2386910',
    '560': 'P9190612',
    '561': 'B7453065',
    '562': 'D207360A',
    '563': 'A3329480',
    '564': 'H8589331',
    '565': 'H373855A',
    '566': 'P3301765',
    '567': 'T0275217',
    '570': 'X1298734',
    '571': 'R5183838',
    '572': 'N1532497',
    '574': 'D7897872',
    '575': 'E6005768',
    '576': 'P8941738',
    '578': 'F1626643',
    '580': 'K1342118',
    '581': 'W0404155',
    '582': 'A9172737',
    '583': 'A9881843',
    '584': 'E3177304',
    '585': 'L1587857',
    '586': 'G8415527',
    '587': 'D5257191',
    '588': 'F8494351',
    '590': 'L6972449',
    '591': 'E2301192',
    '592': 'C4366830',
    '593': 'Z4695608',
    '595': 'V6227384',
    '596': 'Q5866797',
    '597': 'G667696A',
    '598': 'I7492507',
    '601': 'K0383228',
    '602': 'Z0303888',
    '603': 'M3590165',
    '605': 'A7098157',
    '606': 'T2142052',
    '608': 'B1599165',
    '609': 'X0615124',
    '610': 'F6151732',
    '611': 'J8340886',
    '612': 'E4968127',
    '613': 'F8856393',
    '615': 'B8852745',
    '617': 'D9897713',
    '619': 'H2234620',
    '620': 'V0067407',
    '621': 'B3057661',
    '622': 'D3634540',
    '625': 'B0461127',
    '626': 'H9967402',
    '627': 'K6681123',
    '628': 'H9193504',
    '629': 'E5088929',
    '630': 'W0223843',
    '750': 'N5786051',
    '751': 'G8243165',
    '752': 'I019067A',
    '753': 'M7843718',
    '754': 'W4505770',
    '756': 'S3454624',
    '757': 'H7417065',
    '758': 'E5963692',
    '759': 'A2955086',
    '760': 'N4083936',
    '761': 'A5941108',
    '762': 'M5467301',
    '763': 'C2394853',
    '764': 'B1758735',
    '765': 'C0101980',
    '766': 'D5343705',
    '767': 'O386600A',
    '769': 'R0074496',
    '771': 'G3254134',
    '772': 'F8159315',
    '773': 'R5815982',
    '775': 'J0653516',
    '776': 'W2579963',
    '777': 'D3356664',
    '778': 'G6847829',
    '779': 'B4554162',
    '780': 'I8140280',
    '782': 'F5482263',
    '783': 'U2264312',
    '784': 'E4032466',
    '785': 'T4570477',
    '787': 'L8583202',
    '788': 'O5030820',
    '790': 'B1346623',
    '791': 'F545667A',
    '792': 'B1737517',
    '793': 'X913028A',
    '795': 'G8618053',
    '796': 'N4842381',
    '797': 'M7900169',
    '798': 'H622963A',
    '800': 'N789806A',
    '801': 'Y016107A',
    '802': 'H2908001',
    '803': 'K9888772',
    '804': 'H6160729',
    '805': 'A4677156',
    '806': 'G6604438',
    '807': 'K9904549',
    '808': 'A4211696',
    '809': 'Q2880624',
    '850': 'K693529A',
    '851': 'J3496144',
    '852': 'K4855035',
    '853': 'C881143A',
    '855': 'A8706908',
    '857': 'D1510410',
    '858': 'C4282440',
    '859': 'B3497629',
    '861': 'L4180006',
    '862': 'O6559922',
    '863': 'R2179236',
    '864': 'H5373796',
    '865': 'U3607094',
    '866': 'R3809861',
    '867': 'I5662065',
    '868': 'I9417642',
    '870': 'E299581A',
    '871': 'B3850701',
    '872': 'S485782A'
}

# nl = '\n'
# nc = Netcat('secondary.pwnable.hk', 50003)
# output = nc.read().decode('utf-8')
# t = int(output.split('Current time: ')[1].split('\n')[0]) % 1000
# hkid = f'L9011962\n'
# # print(hkid.encode('utf-8'))
# nc.write(hkid.encode('utf-8'))
# output2 = nc.read().decode('utf-8')
# print(output2)
# nc.write(nl.encode('utf-8'))
# output3 = nc.read().decode('utf-8')
# print(output3)
'''
==============================================================================================================================
'''
nl = '\n'
while True:
    nc = Netcat('secondary.pwnable.hk', 50003)
    output = nc.read().decode('utf-8') # Welcome!
    try:
        t = int(output.split('Current time: ')[1].split('\n')[0]) % 1000
        hkid = d[f'{t:03}'] # if not found skip
        nc.write(f"{hkid}{nl}".encode('utf-8'))

        output2 = nc.read().decode('utf-8') # Please press enter to continue...
        print(f'{hkid} > {output2}')
        nc.write(nl.encode('utf-8'))

        output3 = nc.read().decode('utf-8') # Flag?
        if 'jackpot' in output3:
            print(output3)
            break
        else:
            print(f'{t} failed (hkid={hkid}).')
    except:
        pass    
    nc.close()
    
    print(t)
    time.sleep(1)